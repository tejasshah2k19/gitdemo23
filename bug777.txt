this is solution of bug777

my changes
new changes